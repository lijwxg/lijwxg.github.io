#+hugo_base_dir: /Users/li/projects/blog/lijwxg

date: 2018-07-15 15:10:53

* [树莓派系统安装](https://www.raspberrypi.org/documentation/installation/installing-images/)

1. 首先把U盘插入树莓派，然后查看一下是否有被识别到。

    #+begin_src
    sudo fdisk -l
    #+end_src

    这里好像一定要是sudo才行，如果不获取权限好像什么都不显示。其中/dev/mmc表示的是TF卡，容量是8G，而/dev/sda/表示的是我们的第一个硬件（U盘），容量也是8G，只有一个分区。

1. 查看了U盘已经正确被识别，现在准备进行挂载。

    新建一个目录

    #+begin_src
    sudo mkdir /mnt/usb_flash
    #+end_src

1. 然后挂载设备

    #+begin_src
    sudo mount /dev/sda1 /mnt/usb_flash/
    #+end_src

1. 虽然挂载成功，但是迅雷远程下载的时候提示“没有检测到存储设备” 好像挂载后普通用户没权限写入的问题，挂载的时候加入归属。

    #+begin_src
    sudo mount -o uid=pi,gid=pi /dev/sda1 /mnt/usb-flash/
    #+end_src

1. 需要拔出U盘的时候，可以这样取消挂载

    #+begin_src
    sudo umount /mnt/usb_flash
    #+end_src

1. 如果提示设备在忙，那么可以使用下面的方法尝试。  
    问题现象：

    #+begin_src
    umount /dev/sda1
    umount: /mnt/usb: device is busy
    #+end_src

1. 查找占用目录进程：

    #+begin_src
    lsof |grep /mnt/usb
    bash 1971 root cwd DIR 8,1 16384 1 /mnt/usb/
    bash 2342 root 3r DIR 8,1 16384 1 /mnt/usb/
    #+end_src

1. 杀掉进程：

    #+begin_src
    kill -9 1971
    kill -9 2342
    #+end_src

1. 卸载：

    #+begin_src
    umount /mnt/usb
    #+end_src
